!function(){"use strict";var n={9858:function(n,e,t){var r=t(4165),o=t(5671),i=t(3144),a=t(136),l=t(9388),u=t(7465),c=t.n(u),s=function(){function n(e,t){(0,o.Z)(this,n),this.listHeader=e,this.rowIndex=t,this.up=void 0,this.down=void 0,this.left=void 0,this.right=void 0,this.up=this,this.down=this,this.left=this,this.right=this,null===e||void 0===e||e.addDataObject(this)}return(0,i.Z)(n,[{key:"appendToRow",value:function(n){this.left.right=n,n.right=this,n.left=this.left,this.left=n}},{key:"appendToColumn",value:function(n){this.up.down=n,n.down=this,n.up=this.up,this.up=n}},{key:"unlinkFromColumn",value:function(){this.down.up=this.up,this.up.down=this.down}},{key:"relinkIntoColumn",value:function(){this.down.up=this,this.up.down=this}},{key:"loopUp",value:function(n){this.loop(n,"up")}},{key:"loopDown",value:function(n){this.loop(n,"down")}},{key:"loopLeft",value:function(n){this.loop(n,"left")}},{key:"loopRight",value:function(n){this.loop(n,"right")}},{key:"loop",value:function(n,e){for(var t=this[e];t!==this;t=t[e])n(t)}}]),n}(),f=t(7326),v=function(n){(0,a.Z)(t,n);var e=(0,l.Z)(t);function t(){var n;return(0,o.Z)(this,t),(n=e.call(this)).previousColumnObject=void 0,n.nextColumnObject=void 0,n.numberOfRows=void 0,n.previousColumnObject=(0,f.Z)(n),n.nextColumnObject=(0,f.Z)(n),n.numberOfRows=0,n}return(0,i.Z)(t,[{key:"appendColumnHeader",value:function(n){this.previousColumnObject.nextColumnObject=n,n.nextColumnObject=this,n.previousColumnObject=this.previousColumnObject,this.previousColumnObject=n}},{key:"unlinkColumnHeader",value:function(){this.nextColumnObject.previousColumnObject=this.previousColumnObject,this.previousColumnObject.nextColumnObject=this.nextColumnObject}},{key:"relinkColumnHeader",value:function(){this.nextColumnObject.previousColumnObject=this,this.previousColumnObject.nextColumnObject=this}},{key:"addDataObject",value:function(n){this.appendToColumn(n),this.numberOfRows++}},{key:"unlinkDataObject",value:function(n){n.unlinkFromColumn(),this.numberOfRows--}},{key:"relinkDataObject",value:function(n){n.relinkIntoColumn(),this.numberOfRows++}},{key:"loopNext",value:function(n){for(var e=this.nextColumnObject;e!==this;e=e.nextColumnObject)n(e)}}]),t}(s),h=(0,r.Z)().mark(d);var p=function(n){(0,a.Z)(t,n);var e=(0,l.Z)(t);function t(){var n;return(0,o.Z)(this,t),(n=e.call(this)).checkOptions=function(n){if(void 0!==(null===n||void 0===n?void 0:n.numSolutions)){if(!Number.isInteger(n.numSolutions))throw new Error("options.numSolutions must be an integer");if(n.numSolutions<0)throw new Error("options.numSolutions can't be negative - don't be silly")}if(void 0!==(null===n||void 0===n?void 0:n.numPrimaryColumns)){if(!Number.isInteger(n.numPrimaryColumns))throw new Error("options.numPrimaryColumns must be an integer");if(n.numPrimaryColumns<0)throw new Error("options.numPrimaryColumns can't be negative - don't be silly")}},n}return(0,i.Z)(t,[{key:"solve",value:function(n,e){var t;this.checkOptions(e);for(var r=null!==(t=null===e||void 0===e?void 0:e.numSolutions)&&void 0!==t?t:Number.MAX_SAFE_INTEGER,o=[],i=this.solutionGenerator(n,e),a=0;a<r;a++){var l=i.next();if(l.done)break;o.push(l.value)}return o}},{key:"solutionGenerator",value:(0,r.Z)().mark((function n(e,t){var o,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.checkOptions(t),o=m(e,t),i=new b(this,o),n.delegateYield(d(i,t),"t0",4);case 4:case"end":return n.stop()}}),n,this)}))}]),t}(c()),m=function(n,e){var t,r=null!==(t=null===e||void 0===e?void 0:e.numPrimaryColumns)&&void 0!==t?t:n[0].length,o=new v,i=new Map,a=!1;return n.forEach((function(n,t){var l;t%1e3===0&&(null!==e&&void 0!==e&&null!==(l=e.checkForCancellation)&&void 0!==l&&l.call(e)&&(a=!0));if(!a){var u=void 0;n.forEach((function(n,e){if(0===t){var a=new v;e<r&&o.appendColumnHeader(a),i.set(e,a)}if(n){var l=i.get(e),c=new s(l,t);u?u.appendToRow(c):u=c}}))}})),o},y=function(n,e){return n-e};function d(n,e){var t,o,i,a,l;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=null!==(t=null===e||void 0===e?void 0:e.checkForCancellationFrequency)&&void 0!==t?t:100,n.getStepIndex()%o!==0){r.next=4;break}if(null===e||void 0===e||null===(i=e.checkForCancellation)||void 0===i||!i.call(e)){r.next=4;break}return r.abrupt("return");case 4:if(n.raiseSearchStepEvent(),!n.isEmpty()){r.next=11;break}if(!n.currentSolution.length){r.next=10;break}return n.raiseSolutionFoundEvent(),r.next=10,n.currentSolution.slice().sort(y);case 10:return r.abrupt("return");case 11:a=w(n),k(a),l=a.down;case 14:if(l===a){r.next=23;break}return n.pushRowIndex(l.rowIndex),l.loopRight((function(n){return k(n.listHeader)})),r.delegateYield(d(n,e),"t0",18);case 18:l.loopLeft((function(n){return g(n.listHeader)})),n.popRowIndex();case 20:l=l.down,r.next=14;break;case 23:g(a);case 24:case"end":return r.stop()}}),h)}var w=function(n){var e=void 0;return n.root.loopNext((function(n){(!e||n.numberOfRows<e.numberOfRows)&&(e=n)})),e},k=function(n){n.unlinkColumnHeader(),n.loopDown((function(n){return n.loopRight((function(n){return n.listHeader.unlinkDataObject(n)}))}))},g=function(n){n.loopUp((function(n){return n.loopLeft((function(n){return n.listHeader.relinkDataObject(n)}))})),n.relinkColumnHeader()},b=function(){function n(e,t){(0,o.Z)(this,n),this.dlx=e,this.root=t,this.currentSolution=[],this.stepIndex=0,this.solutionIndex=0}return(0,i.Z)(n,[{key:"getStepIndex",value:function(){return this.stepIndex}},{key:"isEmpty",value:function(){return this.root.nextColumnObject===this.root}},{key:"pushRowIndex",value:function(n){this.currentSolution.push(n)}},{key:"popRowIndex",value:function(){this.currentSolution.pop()}},{key:"raiseSearchStepEvent",value:function(){if(this.dlx.listenerCount("step")>0&&this.currentSolution.length){var n={partialSolution:this.currentSolution.slice().sort(y),stepIndex:this.stepIndex++};this.dlx.emit("step",n)}}},{key:"raiseSolutionFoundEvent",value:function(){if(this.dlx.listenerCount("solution")>0){var n={solution:this.currentSolution.slice().sort(y),solutionIndex:this.solutionIndex++};this.dlx.emit("solution",n)}}}]),n}(),V=t(7762),C=t(3433),Z=function(n){return Array.from(Array(n).keys())},S=function(n){return n.reduce((function(n,e){return n+e}),0)};function I(n,e){return t=n.map(e),Math.max.apply(Math,(0,C.Z)(t));var t}function z(n,e){return n===e}function R(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z;return n.filter((function(n){return!e.some((function(e){return t(n,e)}))}))}var x,H,L=function(n){return Array.from(n).reverse().join("")},P=function(n){return{row:n.row-1,col:n.col}},X=function(n){return{row:n.row+1,col:n.col}},N=function(n){return{row:n.row,col:n.col-1}},O=function(n){return{row:n.row,col:n.col+1}},W=function(n,e){return n.row===e.row&&n.col===e.col},j=function(n,e){var t=n.row-e.row,r=n.col-e.col;return 0!==t?t:r};function A(n){var e=new XMLHttpRequest;e.open("GET",n,!1);try{e.send(null)}catch(t){return!0}return!1}!function(n){n[n.Clean=0]="Clean",n[n.Solving=1]="Solving",n[n.Dirty=2]="Dirty"}(x||(x={})),function(n){n[n.FirstSolution=0]="FirstSolution",n[n.SearchSteps=1]="SearchSteps"}(H||(H={}));var E,B=t(1413),M=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t=this;return Z(9).flatMap((function(n){return Z(9).map((function(e){return{row:n,col:e}}))})).flatMap((function(e){var r=n.initialValues.find((function(n){return W(n.coords,e)}));return r?t._buildInternalRowsForInitialValue(r):t._buildInternalRowsForCoords(e)}))}},{key:"_buildInternalRowsForInitialValue",value:function(n){return[(0,B.Z)((0,B.Z)({},n),{},{isInitialValue:!0})]}},{key:"_buildInternalRowsForCoords",value:function(n){return Z(9).map((function(n){return n+1})).map((function(e){return{coords:n,value:e,isInitialValue:!1}}))}},{key:"internalRowToMatrixRow",value:function(n){var e=n.coords,t=e.row,r=e.col,o=this._rowColToBox(t,r),i=n.value-1,a=this._oneHot(t,r),l=this._oneHot(t,i),u=this._oneHot(r,i),c=this._oneHot(o,i);return a.concat(l).concat(u).concat(c)}},{key:"_oneHot",value:function(n,e){var t=Array(81).fill(0);return t[9*n+e]=1,t}},{key:"_rowColToBox",value:function(n,e){return Math.floor(n-n%3+e/3)}},{key:"getNumPrimaryColumns",value:function(n){}}]),n}();!function(n){n[n.North=0]="North",n[n.South=1]="South",n[n.East=2]="East",n[n.West=3]="West"}(E||(E={}));var F,T,G=function(n){var e=n.length,t=n[0].length,r=Z(e),o=Z(t).map((function(e){return r.map((function(t){return n[t][e]})).join("")}));return _(o)},_=function(n){return n.map(L)},D=function(n){var e,t=n.length,r=n[0].length,o=[],i=(0,V.Z)(Z(t));try{for(i.s();!(e=i.n()).done;){var a,l=e.value,u=(0,V.Z)(Z(r));try{for(u.s();!(a=u.n()).done;){var c=a.value;if("X"===n[l][c]){var s={row:l,col:c};o.push(s)}}}catch(f){u.e(f)}finally{u.f()}}}catch(f){i.e(f)}finally{i.f()}return o},U=t(9439),J=new Map([["F",[" XX","XX "," X "]],["I",["X","X","X","X","X"]],["L",["X ","X ","X ","XX"]],["N",[" X"," X","XX","X "]],["P",["XX","XX","X "]],["T",["XXX"," X "," X "]],["U",["X X","XXX"]],["V",["X  ","X  ","XXX"]],["W",["X  ","XX "," XX"]],["X",[" X ","XXX"," X "]],["Y",[" X","XX"," X"," X"]],["Z",["XX "," X "," XX"]]]),Y=Array.from(J).map((function(n){var e=(0,U.Z)(n,2);return{label:e[0],pattern:e[1]}})),q=function(n){return(0,B.Z)((0,B.Z)({},n),{},{reflected:!0,pattern:_(n.pattern)})},K=function(n){return{orientation:n.orientation,reflected:n.reflected,coordsList:D(n.pattern)}},Q=Y.map((function(n){for(var e=n.label,t=n.pattern,r={orientation:E.North,reflected:!1,pattern:t},o=q(r),i={orientation:E.East,reflected:!1,pattern:G(r.pattern)},a=q(i),l={orientation:E.South,reflected:!1,pattern:G(i.pattern)},u=q(l),c={orientation:E.West,reflected:!1,pattern:G(l.pattern)},s=[r,o,i,a,l,u,c,q(c)],f=new Set,v=[],h=0,p=s;h<p.length;h++){var m=p[h],y=m.pattern.join("|");f.has(y)||(f.add(y),v.push(m))}return{label:e,variations:v.map(K)}})),$=function(){function n(){(0,o.Z)(this,n),this.allLocations=Z(8).flatMap((function(n){return Z(8).map((function(e){return{row:n,col:e}}))}))}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t=this;return this.allPossiblePiecePlacements().filter((function(n){return t.isValidPiecePlacement(n)}))}},{key:"internalRowToMatrixRow",value:function(n){var e=this.makePieceColumns(n),t=this.makeLocationColumns(n);return e.concat(t)}},{key:"getNumPrimaryColumns",value:function(n){}},{key:"isValidPiecePlacement",value:function(n){var e,t=(0,V.Z)(n.variation.coordsList);try{for(t.s();!(e=t.n()).done;){var r=e.value,o=n.location.row+r.row,i=n.location.col+r.col;if(o>=8||i>=8)return!1;if((3===o||4===o)&&(3===i||4===i))return!1}}catch(a){t.e(a)}finally{t.f()}return!0}},{key:"allPossiblePiecePlacements",value:function(){var n,e=[],t=Q.slice(0,1).map((function(n){return n.label})),r=(0,V.Z)(Q);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=t.includes(i.label)?i.variations.slice(0,1):i.variations,l=(0,V.Z)(a);try{for(l.s();!(o=l.n()).done;){var u,c=o.value,s=(0,V.Z)(this.allLocations);try{for(s.s();!(u=s.n()).done;){var f=u.value,v={label:i.label,variation:c,location:f};e.push(v)}}catch(h){s.e(h)}finally{s.f()}}}catch(h){l.e(h)}finally{l.f()}}}catch(h){r.e(h)}finally{r.f()}return e}},{key:"makePieceColumns",value:function(n){var e=Array(Q.length).fill(0);return e[Q.findIndex((function(e){return e.label===n.label}))]=1,e}},{key:"makeLocationColumns",value:function(n){var e,t=n.variation.coordsList.map((function(e){return 8*(n.location.row+e.row)+(n.location.col+e.col)})),r=Array(64).fill(0),o=(0,V.Z)(t);try{for(o.s();!(e=o.n()).done;){r[e.value]=1}}catch(a){o.e(a)}finally{o.f()}var i=[27,28,35,36];return r.filter((function(n,e){return!i.includes(e)}))}}]),n}();!function(n){n[n.Black=0]="Black",n[n.White=1]="White"}(F||(F={})),function(n){n[n.North=0]="North",n[n.South=1]="South",n[n.East=2]="East",n[n.West=3]="West"}(T||(T={}));var nn,en=function(n){var e=n.length,t=n[0].length,r=Z(e),o=Z(t).map((function(e){return r.map((function(t){return n[t][e]})).join("")}));return tn(o)},tn=function(n){return n.map(L)},rn=function(n){var e,t=n.length,r=n[0].length,o=[],i=(0,V.Z)(Z(t));try{for(i.s();!(e=i.n()).done;){var a,l=e.value,u=(0,V.Z)(Z(r));try{for(u.s();!(a=u.n()).done;){var c=a.value,s={row:l,col:c};switch(n[l][c]){case"B":o.push({coords:s,colour:F.Black});break;case"W":o.push({coords:s,colour:F.White})}}}catch(f){u.e(f)}finally{u.f()}}}catch(f){i.e(f)}finally{i.f()}return o},on=new Map([["A",["B ","WB","B ","W "]],["B",["B  ","WBW"]],["C",["W ","BW"]],["D",[" WB"," B ","BW "]],["E",["W ","BW"," B"," W"]],["F",["WB "," W "," BW"]],["G",["WB "," WB"]],["H",["B ","WB","B "]],["I",["B ","W ","BW","W "]],["J",[" B"," W"," B","BW"]],["K",["  W"," WB","WB "]],["L",["B ","W ","BW"]],["M",[" B"," W","WB","B "]],["N",["W ","B ","W ","BW"]]]),an=Array.from(on).map((function(n){var e=(0,U.Z)(n,2);return{label:e[0],pattern:e[1]}})),ln=function(n){return{orientation:n.orientation,squares:rn(n.pattern)}},un=an.map((function(n){for(var e=n.label,t=n.pattern,r={orientation:T.North,pattern:t},o={orientation:T.East,pattern:en(r.pattern)},i={orientation:T.South,pattern:en(o.pattern)},a=[r,o,i,{orientation:T.West,pattern:en(i.pattern)}],l=new Set,u=[],c=0,s=a;c<s.length;c++){var f=s[c],v=f.pattern.join("|");l.has(v)||(l.add(v),u.push(f))}return{label:e,variations:u.map(ln)}})),cn=function(){function n(){(0,o.Z)(this,n),this.allLocations=Z(8).flatMap((function(n){return Z(8).map((function(e){return{row:n,col:e}}))}))}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t=this;return this.allPossiblePiecePlacements().filter((function(n){return t.isValidPiecePlacement(n)}))}},{key:"internalRowToMatrixRow",value:function(n){var e=this.makePieceColumns(n),t=this.makeLocationColumns(n);return e.concat(t)}},{key:"getNumPrimaryColumns",value:function(n){}},{key:"isValidPiecePlacement",value:function(n){var e,t=(0,V.Z)(n.variation.squares);try{for(t.s();!(e=t.n()).done;){var r=e.value,o=r.coords,i=r.colour,a=n.location.row+o.row,l=n.location.col+o.col;if(a<0||a>=8)return!1;if(l<0||l>=8)return!1;if(i!==((a+l)%2!==0?F.White:F.Black))return!1}}catch(u){t.e(u)}finally{t.f()}return!0}},{key:"allPossiblePiecePlacements",value:function(){var n,e=[],t=un.slice(0,1).map((function(n){return n.label})),r=(0,V.Z)(un);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=t.includes(i.label)?i.variations.slice(0,1):i.variations,l=(0,V.Z)(a);try{for(l.s();!(o=l.n()).done;){var u,c=o.value,s=(0,V.Z)(this.allLocations);try{for(s.s();!(u=s.n()).done;){var f=u.value,v={label:i.label,variation:c,location:f};e.push(v)}}catch(h){s.e(h)}finally{s.f()}}}catch(h){l.e(h)}finally{l.f()}}}catch(h){r.e(h)}finally{r.f()}return e}},{key:"makePieceColumns",value:function(n){var e=Array(un.length).fill(0);return e[un.findIndex((function(e){return e.label===n.label}))]=1,e}},{key:"makeLocationColumns",value:function(n){var e,t=n.variation.squares.map((function(e){var t=e.coords;return 8*(n.location.row+t.row)+(n.location.col+t.col)})),r=Array(64).fill(0),o=(0,V.Z)(t);try{for(o.s();!(e=o.n()).done;){r[e.value]=1}}catch(i){o.e(i)}finally{o.f()}return r}}]),n}(),sn=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){return Z(n.size).flatMap((function(e){return Z(n.size).map((function(n){return{row:e,col:n}}))})).map((function(e){return{puzzle:n,coords:e}}))}},{key:"getNumPrimaryColumns",value:function(n){return 2*n.size}},{key:"internalRowToMatrixRow",value:function(n){var e=n.coords,t=e.row,r=e.col,o=n.puzzle.size,i=o+o-3,a=Array(o).fill(0),l=Array(o).fill(0),u=Array(i).fill(0),c=Array(i).fill(0);a[t]=1,l[r]=1;var s=t+r-1;s>=0&&s<i&&(u[s]=1);var f=o-1-r+t-1;return f>=0&&f<i&&(c[f]=1),a.concat(l).concat(u).concat(c)}}]),n}();!function(n){n[n.North=0]="North",n[n.South=1]="South",n[n.East=2]="East",n[n.West=3]="West"}(nn||(nn={}));var fn,vn=function(n){switch(n){case nn.North:return nn.East;case nn.South:return nn.West;case nn.East:return nn.South;case nn.West:return nn.North}},hn=new Map([["F",{lineSegments:"H00 V00 H10 V10",polyLines:"0,1 0,0 1,0 1,1|1,1 1,0 2,0"}],["H",{lineSegments:"V00 V10 H10 V11",polyLines:"0,0 1,0 1,1 2,1|2,0 1,0 1,1 2,1"}],["I",{lineSegments:"V00 V10 V20 V30 I10 I20 I30",polyLines:"0,0 1,0 2,0 3,0 4,0"}],["J",{lineSegments:"V10 H20 V11 V01 I11",polyLines:"1,0 2,0 2,1 1,1 0,1"}],["L",{lineSegments:"V00 V10 V20 H30 I10 I20",polyLines:"0,0 1,0 2,0 3,0 3,1"}],["N",{lineSegments:"V20 H20 V01 V11 I11",polyLines:"3,0 2,0 2,1 1,1 0,1"}],["O",{lineSegments:"H00 V01 H10 V00",polyLines:"0,0 0,1 1,1 1,0 0,0"}],["P",{lineSegments:"H00 V01 H10 V10",polyLines:"0,0 0,1 1,1 1,0 2,0"}],["R",{lineSegments:"H10 V11 V01 H01",polyLines:"1,0 1,1 2,1|1,0 1,1 0,1 0,2"}],["T",{lineSegments:"H00 H01 V01 V11 I11",polyLines:"0,0 0,1 1,1 2,1|0,2 0,1 1,1 2,1"}],["U",{lineSegments:"V00 H10 H11 V02 I11",polyLines:"0,0 1,0 1,1 1,2 0,2"}],["V",{lineSegments:"V00 V10 H20 H21 I10 I21",polyLines:"0,0 1,0 2,0 2,1 2,2"}],["W",{lineSegments:"V00 H10 V11 H21",polyLines:"0,0 1,0 1,1 2,1 2,2"}],["X",{lineSegments:"V01 V11 H10 H11",polyLines:"1,0 1,1 0,1|0,1 1,1 1,2|1,2 1,1 2,1|2,1 1,1 1,0"}],["Y",{lineSegments:"H10 V01 V11 V21 I21",polyLines:"1,0 1,1 0,1|1,0 1,1 2,1 3,1"}],["Z",{lineSegments:"H00 V01 V11 H21 I11",polyLines:"0,0 0,1 1,1 2,1 2,2"}]]),pn=function(n){return n.split("|").map((function(n){return n.trim()})).filter(Boolean).map(mn)},mn=function(n){return n.split(/\s/).map((function(n){return n.trim()})).filter(Boolean).map((function(n){return{row:Number(n[0]),col:Number(n[2])}}))},yn=Array.from(hn).map((function(n){var e=(0,U.Z)(n,2),t=e[0],r=e[1];return function(n,e,t){var r,o=[],i=[],a=[],l=pn(t),u=e.split(/\s/).map((function(n){return n.trim()})).filter(Boolean),c=(0,V.Z)(u);try{for(c.s();!(r=c.n()).done;){var s=r.value,f=s[0],v={row:Number(s[1]),col:Number(s[2])};switch(f){case"H":o.push(v);break;case"V":i.push(v);break;case"I":a.push(v)}}}catch(h){c.e(h)}finally{c.f()}return{label:n,horizontals:o,verticals:i,junctions:a,polyLines:l}}(t,r.lineSegments,r.polyLines)})),dn=function(n){return{width:n.horizontals.length?I(n.horizontals,(function(n){return n.col}))+1:0,height:n.verticals.length?I(n.verticals,(function(n){return n.row}))+1:0}},wn=function(n){var e=dn(n).width,t=n.horizontals.map((function(n){return{row:n.row,col:e-n.col-1}})),r=n.verticals.map((function(n){return{row:n.row,col:e-n.col}})),o=n.junctions.map((function(n){return{row:n.row,col:e-n.col}})),i=n.polyLines.map((function(n){return n.map((function(n){return{row:n.row,col:e-n.col}}))}));return{orientation:n.orientation,reflected:!n.reflected,horizontals:t,verticals:r,junctions:o,polyLines:i}},kn=function(n){var e=dn(n).height,t=n.verticals.map((function(n){return{row:n.col,col:e-n.row-1}})),r=n.horizontals.map((function(n){return{row:n.col,col:e-n.row}})),o=n.junctions.map((function(n){return{row:n.col,col:e-n.row}})),i=n.polyLines.map((function(n){return n.map((function(n){return{row:n.col,col:e-n.row}}))}));return{orientation:vn(n.orientation),reflected:n.reflected,horizontals:t,verticals:r,junctions:o,polyLines:i}},gn=yn.map((function(n){var e={orientation:nn.North,reflected:!1,horizontals:n.horizontals,verticals:n.verticals,junctions:n.junctions,polyLines:n.polyLines},t=wn(e),r=kn(e),o=wn(r),i=kn(r),a=wn(i),l=kn(i),u=[e,t,r,o,i,a,l,wn(l)],c=new Set,s=[];return u.forEach((function(n){var e=function(n){var e=n.horizontals.slice().sort(j),t=n.verticals.slice().sort(j),r=e.map((function(n){return"H".concat(n.row,":").concat(n.col)})),o=t.map((function(n){return"V".concat(n.row,":").concat(n.col)}));return r.concat(o).join("-")}(n);c.has(e)||(c.add(e),s.push(n))})),{label:n.label,variations:s}})),bn=function(){function n(){(0,o.Z)(this,n),this.allLocations=Z(9).flatMap((function(n){return Z(9).map((function(e){return{row:n,col:e}}))}))}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){return this.allPossiblePiecePlacements(n).filter(this.isValidPiecePlacement)}},{key:"internalRowToMatrixRow",value:function(n){var e=this.makePieceColumns(n),t=this.makeHorizontalsColumns(n),r=this.makeVerticalsColumns(n),o=this.makeJunctionsColumns(n);return e.concat(t).concat(r).concat(o)}},{key:"getNumPrimaryColumns",value:function(n){return 75}},{key:"getPiecesInPlay",value:function(n){return gn.filter((function(e){return e.label!==n.pieceToOmit.label}))}},{key:"isValidPiecePlacement",value:function(n){var e,t=n.location,r=(0,V.Z)(n.variation.horizontals);try{for(r.s();!(e=r.n()).done;){var o=e.value,i=t.row+o.row,a=t.col+o.col;if(i>5)return!1;if(a>4)return!1}}catch(v){r.e(v)}finally{r.f()}var l,u=(0,V.Z)(n.variation.verticals);try{for(u.s();!(l=u.n()).done;){var c=l.value,s=t.row+c.row,f=t.col+c.col;if(s>4)return!1;if(f>5)return!1}}catch(v){u.e(v)}finally{u.f()}return!0}},{key:"allPossiblePiecePlacements",value:function(n){var e,t=[],r=gn.slice().reverse().slice(0,1).map((function(n){return n.label})),o=this.getPiecesInPlay(n),i=(0,V.Z)(o);try{for(i.s();!(e=i.n()).done;){var a,l=e.value,u=r.includes(l.label)?l.variations.slice(0,1):l.variations,c=(0,V.Z)(u);try{for(c.s();!(a=c.n()).done;){var s,f=a.value,v=(0,V.Z)(this.allLocations);try{for(v.s();!(s=v.n()).done;){var h=s.value,p={puzzle:n,label:l.label,variation:f,location:h};t.push(p)}}catch(m){v.e(m)}finally{v.f()}}}catch(m){c.e(m)}finally{c.f()}}}catch(m){i.e(m)}finally{i.f()}return t}},{key:"makePieceColumns",value:function(n){var e=this.getPiecesInPlay(n.puzzle),t=Array(e.length).fill(0);return t[e.findIndex((function(e){return e.label===n.label}))]=1,t}},{key:"makeHorizontalsColumns",value:function(n){var e,t=n.location,r=Array(30).fill(0),o=(0,V.Z)(n.variation.horizontals);try{for(o.s();!(e=o.n()).done;){var i=e.value;r[5*(t.row+i.row)+(t.col+i.col)]=1}}catch(a){o.e(a)}finally{o.f()}return r}},{key:"makeVerticalsColumns",value:function(n){var e,t=n.location,r=Array(30).fill(0),o=(0,V.Z)(n.variation.verticals);try{for(o.s();!(e=o.n()).done;){var i=e.value,a=t.row+i.row;r[5*(t.col+i.col)+a]=1}}catch(l){o.e(l)}finally{o.f()}return r}},{key:"makeJunctionsColumns",value:function(n){var e,t=n.location,r=Array(16).fill(0),o=(0,V.Z)(n.variation.junctions);try{for(o.s();!(e=o.n()).done;){var i=e.value,a=t.row+i.row,l=t.col+i.col;a>0&&a<5&&l>0&&l<5&&(r[4*(a-1)+l-1]=1)}}catch(u){o.e(u)}finally{o.f()}return r}}]),n}(),Vn=Z(10).flatMap((function(n){return Z(9).map((function(e){return{row:n,col:e}}))})).filter((function(n){var e=n.row-4.5,t=n.col-4;return Math.abs(e)+Math.abs(t)<=5})),Cn=Z(9).flatMap((function(n){return Z(10).map((function(e){return{row:n,col:e}}))})).filter((function(n){var e=n.row-4,t=n.col-4.5;return Math.abs(e)+Math.abs(t)<=5})),Zn=Vn.filter((function(n){return Vn.some((function(e){return W(N(n),e)}))}));Vn.concat(Cn.filter((function(n){return!Vn.some((function(e){return W(n,e)}))})));!function(n){n[n.North=0]="North",n[n.South=1]="South",n[n.East=2]="East",n[n.West=3]="West"}(fn||(fn={}));var Sn,In=function(n){switch(n){case fn.North:return fn.East;case fn.South:return fn.West;case fn.East:return fn.South;case fn.West:return fn.North}},zn=new Map([["I",{lineSegments:"V00 V10 V20 V30 I10 I20 I30",polyLines:"0,0 1,0 2,0 3,0 4,0"}],["O",{lineSegments:"H00 V01 H10 V00",polyLines:"0,0 0,1 1,1 1,0 0,0"}],["T",{lineSegments:"H00 H01 V01 V11 I11",polyLines:"0,0 0,1 1,1 2,1|0,2 0,1 1,1 2,1"}],["U",{lineSegments:"V00 H10 H11 V02 I11",polyLines:"0,0 1,0 1,1 1,2 0,2"}],["V",{lineSegments:"V00 V10 H20 H21 I10 I21",polyLines:"0,0 1,0 2,0 2,1 2,2"}],["W",{lineSegments:"V00 H10 V11 H21",polyLines:"0,0 1,0 1,1 2,1 2,2"}],["X",{lineSegments:"V01 V11 H10 H11",polyLines:"1,0 1,1 0,1|0,1 1,1 1,2|1,2 1,1 2,1|2,1 1,1 1,0"}]]),Rn=new Map([["F",{lineSegments:"H00 V00 H10 V10",polyLines:"0,1 0,0 1,0 1,1|1,1 1,0 2,0"}],["H",{lineSegments:"V00 V10 H10 V11",polyLines:"0,0 1,0 1,1 2,1|2,0 1,0 1,1 2,1"}],["J",{lineSegments:"V10 H20 V11 V01 I11",polyLines:"1,0 2,0 2,1 1,1 0,1"}],["L",{lineSegments:"V00 V10 V20 H30 I10 I20",polyLines:"0,0 1,0 2,0 3,0 3,1"}],["N",{lineSegments:"V20 H20 V01 V11 I11",polyLines:"3,0 2,0 2,1 1,1 0,1"}],["P",{lineSegments:"H00 V01 H10 V10",polyLines:"0,0 0,1 1,1 1,0 2,0"}],["R",{lineSegments:"H10 V11 V01 H01",polyLines:"1,0 1,1 2,1|1,0 1,1 0,1 0,2"}],["Y",{lineSegments:"H10 V01 V11 V21 I21",polyLines:"1,0 1,1 0,1|1,0 1,1 2,1 3,1"}],["Z",{lineSegments:"H00 V01 V11 H21 I11",polyLines:"0,0 0,1 1,1 2,1 2,2"}]]),xn=function(n,e,t){var r,o=[],i=[],a=[],l=Hn(t),u=e.split(/\s/).map((function(n){return n.trim()})).filter(Boolean),c=(0,V.Z)(u);try{for(c.s();!(r=c.n()).done;){var s=r.value,f=s[0],v={row:Number(s[1]),col:Number(s[2])};switch(f){case"H":o.push(v);break;case"V":i.push(v);break;case"I":a.push(v)}}}catch(h){c.e(h)}finally{c.f()}return{label:n,horizontals:o,verticals:i,junctions:a,polyLines:l}},Hn=function(n){return n.split("|").map((function(n){return n.trim()})).filter(Boolean).map(Ln)},Ln=function(n){return n.split(/\s/).map((function(n){return n.trim()})).filter(Boolean).map((function(n){return{row:Number(n[0]),col:Number(n[2])}}))},Pn=Array.from(zn).map((function(n){var e=(0,U.Z)(n,2),t=e[0],r=e[1],o=r.lineSegments,i=r.polyLines;return xn(t,o,i)})),Xn=Array.from(Rn).map((function(n){var e=(0,U.Z)(n,2),t=e[0],r=e[1],o=r.lineSegments,i=r.polyLines;return xn(t,o,i)})),Nn=function(n){return{width:n.horizontals.length?I(n.horizontals,(function(n){return n.col}))+1:0,height:n.verticals.length?I(n.verticals,(function(n){return n.row}))+1:0}},On=function(n){var e=Nn(n).height,t=n.verticals.map((function(n){return{row:n.col,col:e-n.row-1}})),r=n.horizontals.map((function(n){return{row:n.col,col:e-n.row}})),o=n.junctions.map((function(n){return{row:n.col,col:e-n.row}})),i=n.polyLines.map((function(n){return n.map((function(n){return{row:n.col,col:e-n.row}}))}));return{orientation:In(n.orientation),reflected:n.reflected,horizontals:t,verticals:r,junctions:o,polyLines:i}},Wn=function(n,e){var t={orientation:fn.North,reflected:!1,horizontals:n.horizontals,verticals:n.verticals,junctions:n.junctions,polyLines:n.polyLines},r=e?function(n){var e=Nn(n).width,t=n.horizontals.map((function(n){return{row:n.row,col:e-n.col-1}})),r=n.verticals.map((function(n){return{row:n.row,col:e-n.col}})),o=n.junctions.map((function(n){return{row:n.row,col:e-n.col}})),i=n.polyLines.map((function(n){return n.map((function(n){return{row:n.row,col:e-n.col}}))}));return{orientation:n.orientation,reflected:!n.reflected,horizontals:t,verticals:r,junctions:o,polyLines:i}}(t):t,o=On(r),i=On(o),a=[r,o,i,On(i)],l=new Set,u=[];return a.forEach((function(n){var e=function(n){var e=n.horizontals.slice().sort(j),t=n.verticals.slice().sort(j),r=e.map((function(n){return"H".concat(n.row,":").concat(n.col)})),o=t.map((function(n){return"V".concat(n.row,":").concat(n.col)}));return r.concat(o).join("-")}(n);l.has(e)||(l.add(e),u.push(n))})),{label:n.label,variations:u}},jn=function(n){return Wn(n,!1)},An=Pn.map(jn).concat(Xn.map(jn)).concat(Xn.map((function(n){return Wn(n,!0)}))),En=(t(184),new Map([["F","#FF7366"],["H","#00E61A"],["I","#660066"],["J","#E6E6FF"],["L","#596673"],["N","#FFFF00"],["O","#CCCC1A"],["P","#994D33"],["R","#9926B2"],["T","#3300B2"],["U","#FF2699"],["V","#00FFFF"],["W","#CCFF00"],["X","#E60000"],["Y","#6659E6"],["Z","#008000"]]),function(){return[Bn("I",fn.North,!1,3,2),Bn("O",fn.North,!1,4,8),Bn("T",fn.North,!1,3,5),Bn("U",fn.West,!1,2,6),Bn("V",fn.South,!1,1,4),Bn("W",fn.East,!1,2,1),Bn("X",fn.North,!1,5,2),Bn("F",fn.West,!1,5,6),Bn("H",fn.South,!1,2,4),Bn("J",fn.South,!1,0,4),Bn("L",fn.North,!1,6,4),Bn("N",fn.East,!1,3,3),Bn("P",fn.North,!1,3,7),Bn("R",fn.East,!1,3,2),Bn("Y",fn.East,!1,1,3),Bn("Z",fn.East,!1,6,5),Bn("F",fn.South,!0,4,1),Bn("H",fn.West,!0,7,2),Bn("J",fn.East,!0,4,0),Bn("L",fn.West,!0,5,5),Bn("N",fn.North,!0,4,5),Bn("P",fn.South,!0,5,4),Bn("R",fn.East,!0,7,4),Bn("Y",fn.West,!0,4,2),Bn("Z",fn.North,!0,1,2)]}),Bn=function(n,e,t,r,o){var i,a=(0,V.Z)(An);try{for(a.s();!(i=a.n()).done;){var l=i.value;if(l.label===n){var u=l.variations.find((function(n){return n.orientation===e&&n.reflected===t}));if(u)return{label:n,variation:u,location:{row:r,col:o}}}}}catch(c){a.e(c)}finally{a.f()}throw new Error("[makeSolutionInternalRow] failed to find variation")},Mn=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){return this.allPossiblePiecePlacements(5).filter(this.isValidPiecePlacement)}},{key:"internalRowToMatrixRow",value:function(n){var e=this.makePieceColumns(n),t=this.makeHorizontalsColumns(n),r=this.makeVerticalsColumns(n),o=this.makeJunctionsColumns(n);return e.concat(t).concat(r).concat(o)}},{key:"getNumPrimaryColumns",value:function(n){return An.length+Vn.length+Cn.length}},{key:"isValidPiecePlacement",value:function(n){var e,t=n.location,r=(0,V.Z)(n.variation.horizontals);try{var o=function(){var n=e.value,r={row:t.row+n.row,col:t.col+n.col};if(!Vn.some((function(n){return W(n,r)})))return{v:!1}};for(r.s();!(e=r.n()).done;){var i=o();if("object"===typeof i)return i.v}}catch(s){r.e(s)}finally{r.f()}var a,l=(0,V.Z)(n.variation.verticals);try{var u=function(){var n=a.value,e={row:t.row+n.row,col:t.col+n.col};if(!Cn.some((function(n){return W(n,e)})))return{v:!1}};for(l.s();!(a=l.n()).done;){var c=u();if("object"===typeof c)return c.v}}catch(s){l.e(s)}finally{l.f()}return!0}},{key:"allPossiblePiecePlacements",value:function(n){var e,t=[],r=En().slice(0,n),o=(0,V.Z)(An);try{var i=function(){var n=e.value,o=r.find((function(e){return e.label===n.label&&e.variation.reflected===n.variations[0].reflected}));if(o)return t.push(o),"continue";var i,a=Z(9).flatMap((function(n){return Z(9).map((function(e){return{row:n,col:e}}))})),l=(0,V.Z)(n.variations);try{for(l.s();!(i=l.n()).done;){var u,c=i.value,s=(0,V.Z)(a);try{for(s.s();!(u=s.n()).done;){var f=u.value,v={label:n.label,variation:c,location:f};t.push(v)}}catch(h){s.e(h)}finally{s.f()}}}catch(h){l.e(h)}finally{l.f()}};for(o.s();!(e=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}return t}},{key:"makePieceColumns",value:function(n){var e=Array(An.length).fill(0);return e[An.findIndex((function(e){return e.label===n.label&&e.variations[0].reflected===n.variation.reflected}))]=1,e}},{key:"makeHorizontalsColumns",value:function(n){var e,t=n.location,r=Array(Vn.length).fill(0),o=(0,V.Z)(n.variation.horizontals);try{var i=function(){var n=e.value,o={row:t.row+n.row,col:t.col+n.col},i=Vn.findIndex((function(n){return W(n,o)}));i>=0&&(r[i]=1)};for(o.s();!(e=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}return r}},{key:"makeVerticalsColumns",value:function(n){var e,t=n.location,r=Array(Cn.length).fill(0),o=(0,V.Z)(n.variation.verticals);try{var i=function(){var n=e.value,o={row:t.row+n.row,col:t.col+n.col},i=Cn.findIndex((function(n){return W(n,o)}));i>=0&&(r[i]=1)};for(o.s();!(e=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}return r}},{key:"makeJunctionsColumns",value:function(n){var e,t=n.location,r=Array(Zn.length).fill(0),o=(0,V.Z)(n.variation.junctions);try{var i=function(){var n=e.value,o={row:t.row+n.row,col:t.col+n.col},i=Zn.findIndex((function(n){return W(n,o)}));i>=0&&(r[i]=1)};for(o.s();!(e=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}return r}}]),n}(),Fn=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t,r=[],o=(0,V.Z)(n.rooms);try{for(o.s();!(t=o.n()).done;){var i,a=t.value,l=(0,V.Z)(a.initialValues);try{for(l.s();!(i=l.n()).done;){var u=i.value,c=u.cell,s=u.value,f={puzzle:n,cell:c,value:s,isInitialValue:!0,room:a};r.push(f)}}catch(S){l.e(S)}finally{l.f()}var v,h=a.initialValues.map((function(n){return n.cell})),p=a.initialValues.map((function(n){return n.value})),m=R(a.cells,h),y=R(Z(a.cells.length).map((function(n){return n+1})),p),d=(0,V.Z)(m);try{for(d.s();!(v=d.n()).done;){var w,k=v.value,g=(0,V.Z)(y);try{for(g.s();!(w=g.n()).done;){var b=w.value,C={puzzle:n,cell:k,value:b,isInitialValue:!1,room:a};r.push(C)}}catch(S){g.e(S)}finally{g.f()}}}catch(S){d.e(S)}finally{d.f()}}}catch(S){o.e(S)}finally{o.f()}return r}},{key:"internalRowToMatrixRow",value:function(n){var e=this.makeLocationColumns(n),t=this.makeRoomColumns(n),r=this.makeRippleColumns(n);return e.concat(t).concat(r)}},{key:"getNumPrimaryColumns",value:function(n){var e=n.size;return e*e*2}},{key:"makeLocationColumns",value:function(n){var e=n.puzzle.size,t=Array(e*e).fill(0),r=n.cell;return t[r.row*e+r.col]=1,t}},{key:"makeRoomColumns",value:function(n){var e=n.puzzle.size,t=Array(e*e).fill(0);return t[n.room.startIndex+n.value-1]=1,t}},{key:"makeRippleColumns",value:function(n){var e=this,t=n.puzzle,r=t.size,o=t.maxValue,i=Z(4*o).map((function(n){return Array(r*r).fill(0)})),a=4*(n.value-1),l=function(t,o){var l,u=e.getRippleCells(n,o),c=i[a+t],s=(0,V.Z)(u);try{for(s.s();!(l=s.n()).done;){var f=l.value;c[f.row*r+f.col]=1}}catch(v){s.e(v)}finally{s.f()}};return l(0,P),l(1,X),l(2,N),l(3,O),i.flat()}},{key:"getRippleCells",value:function(n,e){var t,r=n.puzzle.size,o=n.cell,i=[o],a=(0,V.Z)(Z(n.value));try{for(a.s();!(t=a.n()).done;){t.value;var l=o=e(o),u=l.row,c=l.col;u>=0&&u<r&&c>=0&&c<r&&i.push({row:u,col:c})}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(),Tn=function(n,e){var t=e.start,r=e.end,o=[t],i=[],a=n.colourPairs.length;return Gn(n,o,i,t,r,a),i},Gn=function n(e,t,r,o,i,a){for(var l=function(){var o=c[u];if(W(o,i)){var l=[].concat((0,C.Z)(t),[o]);Dn(l)<=a&&r.push(l)}else{t.findIndex((function(n){return W(n,o)}))<0&&(t.push(o),Dn(t)<=a&&n(e,t,r,o,i,a),t.pop())}},u=0,c=_n(e,o,i);u<c.length;u++)l()},_n=function(n,e,t){var r=n.colourPairs.flatMap((function(n){return[n.start,n.end]}));return[P(e),X(e),N(e),O(e)].filter((function(e){return e.row>=0&&e.row<n.size&&e.col>=0&&e.col<n.size})).filter((function(n){return!function(n){return r.findIndex((function(e){return W(e,n)}))>=0}(n)||W(n,t)}))},Dn=function(n){if(n.length<3)return 0;var e,t=0,r=(0,V.Z)(Z(n.length).slice(1).slice(0,-1));try{for(r.s();!(e=r.n()).done;){var o=e.value,i=n[o-1],a=n[o+1],l=Math.abs(a.row-i.row),u=Math.abs(a.col-i.col);0!==l&&0!==u&&t++}}catch(c){r.e(c)}finally{r.f()}return t},Un=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t,r=[],o=(0,V.Z)(n.colourPairs);try{for(o.s();!(t=o.n()).done;){var i,a=t.value,l=Tn(n,a),u=(0,V.Z)(l);try{for(u.s();!(i=u.n()).done;){var c={puzzle:n,colourPair:a,coordsList:i.value};r.push(c)}}catch(s){u.e(s)}finally{u.f()}}}catch(s){o.e(s)}finally{o.f()}return r}},{key:"internalRowToMatrixRow",value:function(n){var e,t=n.puzzle.size,r=Array(t*t).fill(0),o=(0,V.Z)(n.coordsList);try{for(o.s();!(e=o.n()).done;){var i=e.value;r[i.row*t+i.col]=1}}catch(a){o.e(a)}finally{o.f()}return r}},{key:"getNumPrimaryColumns",value:function(n){}}]),n}(),Jn=function(n,e){return n.runType===e.runType&&n.sum===e.sum&&function(n,e){if(n.length!==e.length)return!1;var t,r=(0,V.Z)(Z(n.length));try{for(r.s();!(t=r.n()).done;){var o=t.value,i=n[o],a=e[o];if(!W(i,a))return!1}}catch(l){r.e(l)}finally{r.f()}return!0}(n.coordsList,e.coordsList)};!function(n){n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical"}(Sn||(Sn={}));var Yn,qn=function(n){var e=[];return Kn(n,0,n.length-1,e),e},Kn=function n(e,t,r,o){if(t===r)o.push(e.slice());else for(var i=t;i<=r;i++)Qn(e,t,i),n(e,t+1,r,o),Qn(e,t,i)},Qn=function(n,e,t){var r=n[e];n[e]=n[t],n[t]=r},$n=Z(9).map((function(n){return n+1})),ne=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t=this,r=[],o=function(e){var o,i=(0,V.Z)(e);try{for(i.s();!(o=i.n()).done;){var a,l=o.value,u=(0,V.Z)(t.findSetsOfValues(l));try{for(u.s();!(a=u.n()).done;){var c,s=a.value,f=(0,V.Z)(qn(s));try{for(f.s();!(c=f.n()).done;){var v=c.value,h={puzzle:n,run:l,values:v};r.push(h)}}catch(p){f.e(p)}finally{f.f()}}}catch(p){u.e(p)}finally{u.f()}}}catch(p){i.e(p)}finally{i.f()}};return o(n.horizontalRuns),o(n.verticalRuns),r}},{key:"findSetsOfValues",value:function(n){var e=[];return function t(r,o,i){var a=R($n,o.flat()),l=[];o.push(l);var u,c=(0,V.Z)(a);try{for(c.s();!(u=c.n()).done;){var s=u.value;i.push(s),l.push(s),r>1?t(r-1,o,i):S(i)===n.sum&&e.push(i.slice()),i.pop()}}catch(f){c.e(f)}finally{c.f()}o.pop()}(n.coordsList.length,[],[]),e}},{key:"internalRowToMatrixRow",value:function(n){var e=n.puzzle,t=n.run,r=n.values,o=this.makeHorizontalRunColumns(e,t),i=this.makeVerticalRunColumns(e,t),a=this.makeHorizontalRunValueColumns(e,t,r),l=this.makeVerticalRunValueColumns(e,t,r);return o.concat(i).concat(a).concat(l)}},{key:"getNumPrimaryColumns",value:function(n){return n.horizontalRuns.length+n.verticalRuns.length}},{key:"makeHorizontalRunColumns",value:function(n,e){var t=Array(n.horizontalRuns.length).fill(0);e.runType===Sn.Horizontal&&(t[this.findHorizontalRunIndex(n,e)]=1);return t}},{key:"makeVerticalRunColumns",value:function(n,e){var t=Array(n.verticalRuns.length).fill(0);e.runType===Sn.Vertical&&(t[this.findVerticalRunIndex(n,e)]=1);return t}},{key:"makeHorizontalRunValueColumns",value:function(n,e,t){var r,o=Array(9*n.unknowns.length).fill(0),i=(0,V.Z)(Z(e.coordsList.length));try{for(i.s();!(r=i.n()).done;){var a,l=r.value,u=t[l],c=e.runType===Sn.Horizontal?this.encodeValueNormal(u):this.encodeValueInverse(u),s=e.coordsList[l],f=this.findUnknownIndex(n,s),v=(0,V.Z)(Z(9));try{for(v.s();!(a=v.n()).done;){var h=a.value;o[9*f+h]=c[h]}}catch(p){v.e(p)}finally{v.f()}}}catch(p){i.e(p)}finally{i.f()}return o}},{key:"makeVerticalRunValueColumns",value:function(n,e,t){var r,o=Array(9*n.unknowns.length).fill(0),i=(0,V.Z)(Z(e.coordsList.length));try{for(i.s();!(r=i.n()).done;){var a,l=r.value,u=t[l],c=e.runType===Sn.Vertical?this.encodeValueNormal(u):this.encodeValueInverse(u),s=e.coordsList[l],f=this.findUnknownIndex(n,s),v=(0,V.Z)(Z(9));try{for(v.s();!(a=v.n()).done;){var h=a.value;o[9*f+h]=c[h]}}catch(p){v.e(p)}finally{v.f()}}}catch(p){i.e(p)}finally{i.f()}return o}},{key:"encodeValueNormal",value:function(n){var e=Array(9).fill(0);return e[n-1]=1,e}},{key:"encodeValueInverse",value:function(n){var e=Array(9).fill(1);return e[n-1]=0,e}},{key:"findHorizontalRunIndex",value:function(n,e){return n.horizontalRuns.findIndex((function(n){return Jn(n,e)}))}},{key:"findVerticalRunIndex",value:function(n,e){return n.verticalRuns.findIndex((function(n){return Jn(n,e)}))}},{key:"findUnknownIndex",value:function(n,e){return n.unknowns.findIndex((function(n){return W(n,e)}))}}]),n}();!function(n){n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical"}(Yn||(Yn={}));var ee,te=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t,r=this,o=n.size,i=[],a=function(t){var a=[];!function l(u,c){if(i.length%1e3!==0||!e())if(0!==c.length){var s,f=c[0],v=c.slice(1),h=S(v),p=v.length,m=Z(o-h-p-f-u+1).map((function(n){return n+u})),y=(0,V.Z)(m);try{for(y.s();!(s=y.n()).done;){var d=s.value,w={startingPosition:d,runLength:f};a.push(w),l(d+f+1,v),a.pop()}}catch(R){y.e(R)}finally{y.f()}}else if(a.length===t.lengths.length){var k,g=a.slice().reverse(),b=[],C=(0,V.Z)(g);try{var I=function(){var n,e=k.value,o=[],i=(0,V.Z)(Z(e.runLength).map((function(n){return n+e.startingPosition})));try{for(i.s();!(n=i.n()).done;){var a=n.value,l=r.makeRunGroupCoords(t,a);o.push(l)}}catch(R){i.e(R)}finally{i.f()}b.push(o)};for(C.s();!(k=C.n()).done;)I()}catch(R){C.e(R)}finally{C.f()}var z={puzzle:n,runGroup:t,coordsLists:b};i.push(z)}}(0,t.lengths)},l=(0,V.Z)(n.horizontalRunGroups);try{for(l.s();!(t=l.n()).done;){a(t.value)}}catch(s){l.e(s)}finally{l.f()}var u,c=(0,V.Z)(n.verticalRunGroups);try{for(c.s();!(u=c.n()).done;){a(u.value)}}catch(s){c.e(s)}finally{c.f()}return i}},{key:"getNumPrimaryColumns",value:function(n){return n.horizontalRunGroups.length+n.verticalRunGroups.length}},{key:"internalRowToMatrixRow",value:function(n){var e=n.puzzle,t=n.runGroup,r=n.coordsLists,o=this.makeRowColumns(e,t),i=this.makeColColumns(e,t),a=this.makeBlockColumns(e,Yn.Horizontal,t,r),l=this.makeBlockColumns(e,Yn.Vertical,t,r);return o.concat(i).concat(a).concat(l)}},{key:"makeRowColumns",value:function(n,e){var t=Array(n.horizontalRunGroups.length).fill(0);e.runGroupType===Yn.Horizontal&&(t[e.row]=1);return t}},{key:"makeColColumns",value:function(n,e){var t=Array(n.verticalRunGroups.length).fill(0);e.runGroupType===Yn.Vertical&&(t[e.col]=1);return t}},{key:"makeBlockColumns",value:function(n,e,t,r){var o=this,i=n.size,a=Array(i*i*2).fill(0),l=r.flat();if(t.runGroupType===e){var u,c=R(Z(i).map((function(n){return o.makeRunGroupCoords(t,n)})),l,W),s=(0,V.Z)(l);try{for(s.s();!(u=s.n()).done;){var f=u.value;this.markOn(a,i,f)}}catch(w){s.e(w)}finally{s.f()}var v,h=(0,V.Z)(c);try{for(h.s();!(v=h.n()).done;){var p=v.value;this.markOff(a,i,p)}}catch(w){h.e(w)}finally{h.f()}}else{var m,y=(0,V.Z)(l);try{for(y.s();!(m=y.n()).done;){var d=m.value;this.markOff(a,i,d)}}catch(w){y.e(w)}finally{y.f()}}return a}},{key:"markOn",value:function(e,t,r){e[2*(r.row*t+r.col)+n.ON_INDEX]=1}},{key:"markOff",value:function(e,t,r){e[2*(r.row*t+r.col)+n.OFF_INDEX]=1}},{key:"makeRunGroupCoords",value:function(n,e){if(n.runGroupType===Yn.Horizontal)return{row:n.row,col:e};if(n.runGroupType===Yn.Vertical)return{row:e,col:n.col};throw new Error("[makeRunGroupCoords] unknown RunGroupType")}}]),n}();te.ON_INDEX=0,te.OFF_INDEX=1,function(n){n[n.Across=0]="Across",n[n.Down=1]="Down"}(ee||(ee={}));var re=function(){function n(){(0,o.Z)(this,n)}return(0,i.Z)(n,[{key:"buildInternalRows",value:function(n,e){var t,r=[],o=(0,V.Z)(n.clues);try{for(o.s();!(t=o.n()).done;){var i,a=t.value,l=(0,V.Z)(a.candidates);try{for(l.s();!(i=l.n()).done;){var u={puzzle:n,clue:a,candidate:i.value};r.push(u)}}catch(c){l.e(c)}finally{l.f()}}}catch(c){o.e(c)}finally{o.f()}return r}},{key:"internalRowToMatrixRow",value:function(n){return this.makeColumns(n)}},{key:"getNumPrimaryColumns",value:function(n){}},{key:"makeColumns",value:function(n){var e,t=n.puzzle.crossCheckingSquares,r=n.clue,o=Array(26*t.length).fill(0),i=function(n){return t.findIndex((function(e){return W(e,n)}))},a=(0,V.Z)(Z(r.coordsList.length));try{for(a.s();!(e=a.n()).done;){var l=e.value,u=i(r.coordsList[l]);if(u>=0){var c,s=n.candidate[l],f=this.encodeLetter(s,r.clueType),v=26*u,h=(0,V.Z)(Z(f.length));try{for(h.s();!(c=h.n()).done;){var p=c.value;o[v+p]=f[p]}}catch(m){h.e(m)}finally{h.f()}}}}catch(m){a.e(m)}finally{a.f()}return o}},{key:"encodeLetter",value:function(n,e){var t=n.toLocaleUpperCase().codePointAt(0)-"A".codePointAt(0),r=e===ee.Across?[1,0]:[0,1],o=(0,U.Z)(r,2),i=o[0],a=o[1],l=Array(26).fill(a);return l[t]=i,l}}]),n}(),oe=new Map([["sudoku",M],["pentominoes",$],["draughtboard-puzzle",cn],["n-queens",sn],["tetrasticks",bn],["aztec-diamond",Mn],["ripple-effect",Fn],["flow-free",Un],["kakuro",ne],["nonogram",te],["crossword",re]]);self.onmessage=function(n){try{if(console.log("[worker onmessage]","ev.data.type:",n.data.type),"solve"===n.data.type){var e=n.data.stopToken,t=n.data.shortName,r=n.data.mode;return void function(n,e,t,r){var o,i,a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=A(n);return t&&e&&(console.log("[worker onSolve]","cancelled!"),self.postMessage({type:"cancelled"})),t};console.log("[worker onSolve]");var l=oe.get(e);if(l){var u=new l;console.log("[worker onSolve]","building internal rows...");var c=u.buildInternalRows(t,a);if(console.log("[worker onSolve]","internalRows.length:",c.length),!a(!0)){console.log("[worker onSolve]","building matrix...");for(var s=[],f=0;f<c.length&&(f%1e3!==0||!a());f++){var v=c[f],h=u.internalRowToMatrixRow(v);s.push(new Uint8Array(h))}var m=s.length,y=null!==(o=null===(i=s[0])||void 0===i?void 0:i.length)&&void 0!==o?o:0;if(console.log("[worker onSolve]","matrix size:","".concat(m,"x").concat(y)),!a(!0)){var d={numSolutions:1,numPrimaryColumns:u.getNumPrimaryColumns(t),checkForCancellation:a},w=0,k=new p;k.addListener("step",(function(n){if(++w%100===0&&console.log("[worker onStep]","searchStepCount:",w),r===H.SearchSteps){var e=n.partialSolution.map((function(n){return c[n]}));self.postMessage({type:"searchStep",solutionInternalRows:e})}})),k.addListener("solution",(function(n){console.log("[worker onSolution]","solutionIndex:",n.solutionIndex,"row count:",n.solution.length);var e=n.solution.map((function(n){return c[n]}));self.postMessage({type:"solutionFound",solutionInternalRows:e})})),console.log("[worker onSolve]","solving matrix...");var g=k.solve(s,d);console.log("[worker onSolve]","searchStepCount:",w),console.log("[worker onSolve]","solutions.length:",g.length),a(!0)||self.postMessage({type:"finished",numSolutionsFound:g.length})}}}else self.postMessage({type:"error",message:'unknown demo short name, "'.concat(e,'"')})}(e,t,n.data.puzzle,r)}if("close"===n.data.type)return void self.close()}catch(o){console.error("error:",o),o instanceof Error?self.postMessage({type:"error",message:o.message}):self.postMessage({type:"error",message:String(o)})}}}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return n[r](i,i.exports,t),i.exports}t.m=n,t.x=function(){var n=t.O(void 0,[625],(function(){return t(9858)}));return n=t.O(n)},function(){var n=[];t.O=function(e,r,o,i){if(!r){var a=1/0;for(s=0;s<n.length;s++){r=n[s][0],o=n[s][1],i=n[s][2];for(var l=!0,u=0;u<r.length;u++)(!1&i||a>=i)&&Object.keys(t.O).every((function(n){return t.O[n](r[u])}))?r.splice(u--,1):(l=!1,i<a&&(a=i));if(l){n.splice(s--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var s=n.length;s>0&&n[s-1][2]>i;s--)n[s]=n[s-1];n[s]=[r,o,i]}}(),t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,{a:e}),e},t.d=function(n,e){for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.f={},t.e=function(n){return Promise.all(Object.keys(t.f).reduce((function(e,r){return t.f[r](n,e),e}),[]))},t.u=function(n){return"static/js/"+n+".b56eb7ce.chunk.js"},t.miniCssF=function(n){},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="/dlxlib-demos/",function(){var n={858:1};t.f.i=function(e,r){n[e]||importScripts(t.p+t.u(e))};var e=self.webpackChunkdlxlib_demos=self.webpackChunkdlxlib_demos||[],r=e.push.bind(e);e.push=function(e){var o=e[0],i=e[1],a=e[2];for(var l in i)t.o(i,l)&&(t.m[l]=i[l]);for(a&&a(t);o.length;)n[o.pop()]=1;r(e)}}(),function(){var n=t.x;t.x=function(){return t.e(625).then(n)}}();t.x()}();
//# sourceMappingURL=858.0213b7f3.chunk.js.map